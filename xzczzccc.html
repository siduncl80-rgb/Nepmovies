<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIDS | Premium Cinema</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #020203; 
            --surface: #0d0d10; 
            --glass: rgba(255, 255, 255, 0.05);
            --accent: #00e5ff; 
            --accent-glow: rgba(0, 229, 255, 0.3);
            --text-main: #ffffff; 
            --text-dim: #b0b0b0;
            --rating-bg: rgba(0, 0, 0, 0.75);
            --premium-gradient: linear-gradient(135deg, #00e5ff 0%, #007bff 100%);
        }

        * { margin:0; padding:0; box-sizing: border-box; font-family: 'Outfit', sans-serif; }
        
        body { 
            background: var(--bg); 
            color: var(--text-main); 
            scroll-behavior: smooth; 
            overflow-x: hidden;
            background-image: radial-gradient(circle at top right, #001a1d, transparent 500px);
        }

        header { 
            padding: 20px 6%; 
            background: rgba(2, 2, 3, 0.85); 
            backdrop-filter: blur(25px);
            position: sticky; top:0; z-index:1000; 
            border-bottom: 1px solid rgba(255,255,255,0.08); 
            display: flex; justify-content: space-between; align-items: center; 
        }

        .logo { 
            font-size: 32px; font-weight: 900; 
            background: var(--premium-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 4px; cursor: pointer;
            filter: drop-shadow(0 0 12px var(--accent-glow));
        }

        .search-container { 
            display: flex; background: var(--glass); 
            border-radius: 12px; padding: 2px 20px; width: 35%; 
            border: 1px solid rgba(255,255,255,0.1);
            transition: 0.4s;
        }
        .search-container:focus-within { 
            border-color: var(--accent); 
            background: rgba(255,255,255,0.08);
            box-shadow: 0 0 25px rgba(0, 229, 255, 0.15);
        }
        .search-container input { background: transparent; border: none; color: white; padding: 12px; width: 100%; outline: none; font-size: 15px; }
        .search-container i { color: var(--accent); cursor: pointer; align-self: center; }

        .tools-bar { 
            display: flex; gap: 12px; padding: 20px 6%; 
            overflow-x: auto; scrollbar-width: none; 
        }
        .t-btn { 
            background: var(--glass); color: var(--text-dim); 
            padding: 10px 22px; border-radius: 10px; cursor: pointer; 
            white-space: nowrap; transition: 0.4s; 
            border: 1px solid rgba(255,255,255,0.05);
            font-weight: 600;
        }
        .t-btn:hover { color: #fff; border-color: rgba(255,255,255,0.2); }
        .t-btn.active { 
            background: var(--accent); color: #000; 
            border-color: var(--accent); 
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .refresh-btn { background: var(--premium-gradient) !important; color: #000 !important; }

        .container { padding: 20px 6%; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 30px; }
        
        .movie-card { 
            background: var(--surface); border-radius: 18px; 
            overflow: hidden; cursor: pointer; 
            transition: all 0.5s cubic-bezier(0.165, 0.84, 0.44, 1); 
            position: relative; border: 1px solid rgba(255,255,255,0.05); 
        }
        .movie-card:hover { 
            transform: translateY(-10px);
            border-color: var(--accent);
            box-shadow: 0 15px 35px rgba(0,0,0,0.7), 0 0 20px var(--accent-glow);
        }
        .movie-card img { width: 100%; height: 270px; object-fit: cover; }
        .movie-card p { 
            padding: 15px; font-size: 15px; font-weight: 700; color: var(--text-main);
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis; 
            background: linear-gradient(to top, var(--surface), transparent);
        }

        .rating-badge {
            position: absolute; top: 12px; left: 12px;
            background: var(--rating-bg); backdrop-filter: blur(8px);
            padding: 4px 10px; border-radius: 8px; font-size: 12px;
            font-weight: 900; color: #ffca28; border: 1px solid rgba(255,255,255,0.1);
            z-index: 5;
        }
        
        .fav-btn { 
            position: absolute; top: 12px; right: 12px; 
            background: var(--rating-bg); backdrop-filter: blur(8px);
            color: #fff; width: 34px; height: 34px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            z-index: 5; transition: 0.3s; border: 1px solid rgba(255,255,255,0.1);
        }
        .fav-btn.active { color: #ff4757; background: #fff; }

        .player-wrapper { 
            position: relative; width: 100%; aspect-ratio: 16/9; 
            background: #000; border-radius: 24px; overflow: hidden; 
            margin-top: 10px; box-shadow: 0 30px 60px rgba(0,0,0,0.8); 
            border: 1px solid rgba(255,255,255,0.1);
        }
        #videoFrame { width: 100%; height: 100%; border: none; }

        .srv-btn { 
            background: var(--glass); color: white; border: 1px solid rgba(255,255,255,0.1); 
            padding: 14px 28px; border-radius: 12px; cursor: pointer; 
            margin-right: 12px; transition: 0.3s; font-weight: 700; 
        }
        .srv-btn.active { 
            background: var(--text-main); color: #000; 
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
        }

        .back-btn { 
            background: transparent; color: var(--accent); 
            padding: 10px 0; cursor: pointer; margin-bottom: 20px; 
            display: inline-flex; align-items: center; gap: 10px; 
            font-weight: 800; border: none; letter-spacing: 1px;
        }

        .page { display: none; }
        .active-page { display: block; animation: fadeIn 0.6s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .load-more { text-align: center; padding: 60px 0; }
        .btn-more { 
            background: var(--glass); border: 1px solid var(--accent); 
            color: var(--accent); padding: 16px 60px; border-radius: 14px; 
            cursor: pointer; font-weight: 800; transition: 0.4s;
        }
        .btn-more:hover { background: var(--accent); color: #000; }

        h2 { font-size: 22px; font-weight: 800; color: var(--accent); margin-bottom: 25px; text-transform: uppercase; letter-spacing: 1px; }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>
</head>
<body>

<header>
    <div class="logo" onclick="location.reload()">SIDS</div>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search movies..." onkeyup="if(event.key==='Enter') searchMovies()">
        <i class="fas fa-search" onclick="searchMovies()"></i>
    </div>
    <div onclick="showPage('favPage')" style="cursor:pointer; color:var(--text-main); font-weight: 700;">
        <i class="fas fa-heart" style="color:#ff4757; margin-right: 8px;"></i> MY LIST
    </div>
</header>

<div class="tools-bar" id="mainTools">
    <div class="t-btn active" onclick="loadTrending()">TRENDING</div>
    <div class="t-btn" onclick="loadByGenre(28)">ACTION</div>
    <div class="t-btn" onclick="loadByGenre(35)">COMEDY</div>
    <div class="t-btn" onclick="loadByGenre(27)">HORROR</div>
    <div class="t-btn" onclick="loadByGenre(878)">SCI-FI</div>
    <div class="t-btn refresh-btn" onclick="refreshMovies()">SHUFFLE</div>
</div>

<main id="home" class="page active-page container">
    <div id="watchedBox" style="display:none; margin-bottom: 50px;">
        <h2><i class="fas fa-play-circle"></i> CONTINUE WATCHING</h2>
        <div class="grid" id="watchedGrid"></div>
    </div>
    <h2 id="gridTitle">EXPLORE MOVIES</h2>
    <div class="grid" id="mainGrid"></div>
    <div class="load-more"><button class="btn-more" onclick="loadNextPage()">LOAD MORE</button></div>
</main>

<main id="favPage" class="page container">
    <button class="back-btn" onclick="showPage('home')"><i class="fas fa-arrow-left"></i> RETURN HOME</button>
    <h2>MY COLLECTION</h2>
    <div class="grid" id="favGrid"></div>
</main>

<main id="streamRoom" class="page container">
    <button class="back-btn" onclick="showPage('home')"><i class="fas fa-chevron-left"></i> BACK</button>
    <div class="player-wrapper">
        <iframe id="videoFrame" src="" allowfullscreen></iframe>
    </div>
    <div style="margin: 30px 0; display: flex; overflow-x: auto; padding-bottom: 10px;">
        <button class="srv-btn active" onclick="changeSrv('xyz', this)">SERVER 1</button>
        <button class="srv-btn" onclick="changeSrv('club', this)">SERVER 2</button>
        <button class="srv-btn" onclick="changeSrv('pro', this)">SERVER 3</button>
    </div>
    <div id="movieData" style="background: var(--glass); padding:40px; border-radius:24px; border: 1px solid rgba(255,255,255,0.05);"></div>
    <h2 style="margin-top:60px;">RECOMMENDED FOR YOU</h2>
    <div class="grid" id="recGrid" style="margin-top:25px;"></div>
</main>

<script>
    (function() {
        window.open = function() { return null; };
        setInterval(() => {
            const frame = document.getElementById('videoFrame');
            if (frame && frame.contentWindow) {
                try { frame.contentWindow.onbeforeunload = function() { return false; }; } catch(e) {}
            }
        }, 1000);
    })();

    const API_KEY = "";
    let curPage = 1, curPath = 'trending/movie/week', curId = null;
    let favorites = JSON.parse(localStorage.getItem('sids_favs') || '[]');

    function showPage(p) {
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active-page'));
        document.getElementById(p).classList.add('active-page');
        document.getElementById('mainTools').style.display = (p === 'streamRoom') ? 'none' : 'flex';
        if(p === 'home') document.getElementById('videoFrame').src = "";
        window.scrollTo(0,0);
    }

    async function fetchData(path, page = 1) {
        const connector = path.includes('?') ? '&' : '?';
        try {
            const r = await fetch(`https://api.themoviedb.org/3/${path}${connector}api_key=${API_KEY}&page=${page}`);
            const d = await r.json(); return d.results || [];
        } catch (e) { return []; }
    }

    async function loadTrending() {
        curPage = 1; curPath = 'trending/movie/week';
        const m = await fetchData(curPath, curPage);
        document.getElementById('gridTitle').innerText = "TRENDING NOW";
        renderGrid('mainGrid', m);
    }

    async function refreshMovies() {
        curPage = Math.floor(Math.random() * 100) + 1;
        const m = await fetchData('discover/movie', curPage);
        document.getElementById('gridTitle').innerText = "RANDOM PICKS";
        renderGrid('mainGrid', m);
    }

    async function searchMovies() {
        const q = document.getElementById('searchInput').value.trim();
        if(!q) return;
        curPage = 1; curPath = `search/movie?query=${encodeURIComponent(q)}`;
        const m = await fetchData(curPath, curPage);
        document.getElementById('gridTitle').innerText = "RESULTS FOR: " + q.toUpperCase();
        renderGrid('mainGrid', m);
        showPage('home');
    }

    async function loadByGenre(id) {
        curPage = 1; curPath = `discover/movie?with_genres=${id}&sort_by=popularity.desc`;
        const m = await fetchData(curPath, curPage);
        document.getElementById('gridTitle').innerText = "TOP MOVIES";
        renderGrid('mainGrid', m);
    }

    async function loadNextPage() {
        curPage++;
        const m = await fetchData(curPath, curPage);
        renderGrid('mainGrid', m, true);
    }

    async function openMovie(id) {
        curId = id;
        const movie = await fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}`).then(r => r.json());
        const recs = await fetchData(`movie/${id}/recommendations`);
        changeSrv('xyz'); // Start with the new Server 1 (xyz)
        saveWatched(id, movie.title, movie.poster_path, movie.vote_average);
        document.getElementById('movieData').innerHTML = `
            <h1 style="font-size: 38px; font-weight: 900; margin-bottom: 10px; color:#fff;">${movie.title}</h1>
            <div style="display:flex; gap:15px; color:var(--accent); font-weight:800; margin-bottom:20px; font-size: 15px;">
                <span>${movie.release_date.split('-')[0]}</span>
                <span style="color:#ffca28;">★ ${movie.vote_average.toFixed(1)}</span>
                <span style="color:var(--text-dim)">${movie.runtime} MIN</span>
            </div>
            <p style="color:var(--text-dim); line-height:1.8; font-size:16px;">${movie.overview}</p>`;
        renderGrid('recGrid', recs.slice(0, 12));
        showPage('streamRoom');
    }

    function changeSrv(srv, btn) {
        const frame = document.getElementById('videoFrame');
        if(srv === 'xyz') frame.src = `https://vidsrc.xyz/embed/movie/${curId}`;
        else if(srv === 'club') frame.src = `https://moviesapi.club/movie/${curId}`;
        else if(srv === 'pro') frame.src = `https://vidsrc.pro/embed/movie/${curId}`;
        
        if(btn) {
            document.querySelectorAll('.srv-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
    }

    function saveWatched(id, title, img, vote) {
        let watched = JSON.parse(localStorage.getItem('sids_watched') || '[]');
        watched = watched.filter(m => m.id !== id);
        watched.unshift({id, title, poster_path: img, vote_average: vote});
        localStorage.setItem('sids_watched', JSON.stringify(watched.slice(0, 6)));
        updateWatchedUI();
    }

    function updateWatchedUI() {
        const watched = JSON.parse(localStorage.getItem('sids_watched') || '[]');
        if(watched.length > 0) {
            document.getElementById('watchedBox').style.display = 'block';
            renderGrid('watchedGrid', watched);
        }
    }

    function toggleFav(e, id, title, img, vote) {
        e.stopPropagation();
        const idx = favorites.findIndex(f => f.id === id);
        if(idx > -1) favorites.splice(idx, 1);
        else favorites.push({id, title, poster_path: img, vote_average: vote});
        localStorage.setItem('sids_favs', JSON.stringify(favorites));
        e.target.closest('.fav-btn').classList.toggle('active');
    }

    function renderGrid(target, movies, append = false) {
        const container = document.getElementById(target);
        if(!movies || movies.length === 0) {
            if(!append) container.innerHTML = "<p style='text-align:center; padding: 50px; opacity: 0.5;'>No content.</p>";
            return;
        }
        const html = movies.map(m => {
            if(!m.poster_path) return ''; 
            const isFav = favorites.some(f => f.id === m.id);
            const rating = m.vote_average ? m.vote_average.toFixed(1) : 'N/A';
            return `
            <div class="movie-card" onclick="openMovie(${m.id})">
                <div class="rating-badge">★ ${rating}</div>
                <div class="fav-btn ${isFav?'active':''}" onclick="toggleFav(event, ${m.id}, '${m.title.replace(/'/g, "\\'")}', '${m.poster_path}', ${m.vote_average})">
                    <i class="fas fa-heart"></i>
                </div>
                <img src="https://image.tmdb.org/t/p/w500${m.poster_path}" loading="lazy">
                <p>${m.title}</p>
            </div>`}).join('');
        if(append) container.innerHTML += html; else container.innerHTML = html;
    }

    window.onload = () => { loadTrending(); updateWatchedUI(); };
</script>
</body>

</html>
